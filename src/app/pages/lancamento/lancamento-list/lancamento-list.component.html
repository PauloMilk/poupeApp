<app-navbar></app-navbar>
<div class="container">
  <app-page-title page-title="Lançamentos" button-text="+ Novo Lançamento" button-link="new" button-class="btn-primary">
  </app-page-title>
  <form>
    <div class="form-group form-inline">
      Busque pelo nome, descrição ou categoria: <input class="form-control ml-2" type="text" name="searchTerm"
        [(ngModel)]="search" (ngModelChange)='changed($event)' />
    </div>
    <ng-container *ngIf="(!loading && resources.length > 0) else noData">
      <table class="table table-striped table-responsive-sm">
        <thead>
          <tr class="d-flex">
            <th class="col-2">Nome</th>
            <th class="col-1">Tipo</th>
            <th class="col-1">Status</th>
            <th class="col-2">Categoria</th>
            <th class="col-2">Valor</th>
            <th class="col-2">Data</th>
            <th class="col-sm-2">Ações</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let lancamento of resources" class="d-flex" [class.table-danger]="lancamento.tipo == 'DESPESA'"
            [class.table-success]="lancamento.tipo != 'DESPESA'" placement="bottom" [ngbTooltip]="lancamento.descricao">
            <td class="col-2" scope="row">{{lancamento.nome}}</td>
            <td class="col-1">{{lancamento.tipo}}</td>
            <td class="col-1">{{lancamento.pagamento}}</td>
            <td class="col-2">{{lancamento.categoria}}</td>
            <td class="col-2">{{lancamento.valor | currency: 'BRL'}}</td>
            <td class="col-2">{{lancamento.data | date: 'dd/MM/yyyy' }}</td>
            <td class="col-sm-2">
              <div class="btn-group" role="group" aria-label="Basic example">
                <button type="button" class="btn btn-info" [routerLink]="['edit', lancamento.id]">Editar</button>
                <button type="button" class="btn btn-danger" (click)="deleteResource(lancamento)">Remover</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <div class="d-flex justify-content-between p-2">
        <ngb-pagination [collectionSize]="collectionSize" [(page)]="page" [pageSize]="size" (pageChange)="getAll()">
        </ngb-pagination>

        <select class="custom-select" style="width: auto" [(ngModel)]="size" name="page" (change)="getAll()">
          <option [ngValue]="5">5 itens por página</option>
          <option [ngValue]="10">10 itens por página</option>
          <option [ngValue]="20">20 itens por página</option>
        </select>
      </div>
    </ng-container>

    <ng-template #noData>
      <hr />
      <div *ngIf="loading" class="d-flex justify-content-center">
        <div class="spinner-border" role="status">
          <span class="sr-only">Loading...</span>
        </div>
      </div>
      <ngb-alert [dismissible]="false" class="text-center" *ngIf="!loading">
        <strong>Sinto muito!</strong> Não foi encontrado nenhum lançamento.
      </ngb-alert>
    </ng-template>
  </form>
</div>

<app-toasts aria-live="polite" aria-atomic="true"></app-toasts>
